import{d as z,b as x,T as t,n as b,o as i,am as H,Q as T,f as m,ai as O,i as M,an as W,g as e,ae as j,ao as U,af as q,z as $,F as G,t as C,r as B,K as R,Y as K,L as Q,P as Y,ap as J,e as u,B as X,w as h,k as Z,aa as V}from"../modules/vue--DFaf9bq.js";import{d as r,a as ee,u as te,e as se,h as ne,j as oe,k as re,l as ae,m as ie,s as le,n as ue,_ as ce}from"../index-Biof53K1.js";import{u as de,a as E,S as me}from"./SlideWrapper-4At8DtMX.js";import{r as pe,u as fe,a as ve,_ as xe,o as _e,b as ge,S as ke,G as Se,c as ye,d as be}from"./shortcuts-CP3LZd26.js";import{_ as we,C as Ce}from"./NoteDisplay.vue_vue_type_style_index_0_lang-czbGriL-.js";import{_ as he}from"./CurrentProgressBar.vue_vue_type_script_setup_true_lang-Dk4Iz8wx.js";import{_ as $e}from"./DrawingControls.vue_vue_type_style_index_0_lang-BP9kateL.js";import{_ as I}from"./IconButton.vue_vue_type_script_setup_true_lang-DZfp_-5S.js";import{a as Me}from"./useSlideInfo-mRfs0_pB.js";import"../modules/shiki-DRqQz0Oh.js";import"./context-BOXK0aAL.js";import"../modules/unplugin-icons-wzabqxJB.js";const ze=z({__name:"NoteStatic",props:{no:{},class:{},clicksContext:{}},setup(p){const l=p,{info:n}=Me(l.no);return(a,c)=>(i(),x(we,{class:b(l.class),note:t(n)?.note,"note-html":t(n)?.noteHTML,"clicks-context":a.clicksContext},null,8,["class","note","note-html","clicks-context"]))}}),De={"h-full":"","w-full":""},Ne={key:0,"w-full":"","h-full":"",flex:"~ col gap-4 items-center justify-center"},Ae=z({__name:"ScreenCaptureMirror",setup(p){const l=H("video"),n=T(null),a=T(!1);async function c(){n.value=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1,selfBrowserSurface:"include",preferCurrentTab:!1}),l.value.srcObject=n.value,l.value.play(),a.value=!0,n.value.addEventListener("inactive",()=>{l.value.srcObject=null,a.value=!1}),n.value.addEventListener("ended",()=>{l.value.srcObject=null,a.value=!1})}return(f,o)=>(i(),m("div",De,[O(e("video",{ref_key:"video",ref:l,class:"w-full h-full object-contain"},null,512),[[W,a.value]]),a.value?M("",!0):(i(),m("div",Ne,[o[0]||(o[0]=e("div",{op50:""},[j(" Use screen capturing to mirror your main screen back to presenter view."),e("br"),j(" Click the button below and "),e("b",null,"select your other monitor or window"),j(". ")],-1)),e("button",{class:"slidev-form-button",onClick:c}," Start Screen Mirroring ")]))]))}});function Fe(){const p=U(100,{controls:!0}),l=q(r,"timerStatus"),n=$(()=>{if(r.timerStatus==="stopped"&&r.timerStartedAt===0)return{h:"",m:"-",s:"--",ms:"-"};p.counter.value;const d=Date.now()-r.timerStartedAt;let _=Math.floor(d/1e3/60/60).toString();_==="0"&&(_="");let S=Math.floor(d/1e3/60).toString();_&&(S=S.padStart(2,"0"));const D=Math.floor(d/1e3%60).toString().padStart(2,"0"),N=Math.floor(d%1e3/100).toString();return{h:_,m:S,s:D,ms:N}});function a(){p.pause(),r.timerStatus="stopped",r.timerStartedAt=0,r.timerPausedAt=0}function c(){r.timerStatus==="stopped"?(r.timerStatus="running",r.timerStartedAt=Date.now()):r.timerStatus==="paused"&&(r.timerStatus="running",r.timerStartedAt=Date.now()-(r.timerPausedAt-r.timerStartedAt)),p.resume()}function f(){r.timerStatus="paused",r.timerPausedAt=Date.now(),p.pause()}function o(){r.timerStatus==="running"?f():c()}return{state:l,timer:n,reset:a,toggle:o,resume:c,pause:f}}const Pe={class:"w-22px cursor-pointer"},je={class:"group-not-hover:hidden flex flex-col items-center"},Be={key:0,class:"i-carbon:pause text-lg"},Te={key:1,class:"i-carbon:play"},Le={class:"text-3xl px-3 my-auto font-mono"},Re={class:"text-base op50"},Ve=z({__name:"TimerInlined",setup(p){const{state:l,timer:n,reset:a,toggle:c}=Fe();return(f,o)=>(i(),m("div",{class:b(["group flex items-center justify-center pl-4 select-none",{running:"text-green6 dark:text-green3",paused:"text-orange6 dark:text-orange3",stopped:"op50"}[t(l)]])},[e("div",Pe,[o[3]||(o[3]=e("div",{class:"i-carbon:time group-hover:hidden text-xl"},null,-1)),e("div",je,[e("div",{class:"relative op-80 hover:op-100",onClick:o[0]||(o[0]=(...d)=>t(c)&&t(c)(...d))},[t(l)==="running"?(i(),m("div",Be)):(i(),m("div",Te))]),e("div",{class:"op-80 hover:op-100",onClick:o[1]||(o[1]=(...d)=>t(a)&&t(a)(...d))},o[2]||(o[2]=[e("div",{class:"i-carbon:renew"},null,-1)]))])]),e("div",Le,[t(n).h?(i(),m(G,{key:0},[e("span",null,C(t(n).h),1),o[4]||(o[4]=e("span",{op50:""},":",-1))],64)):M("",!0),e("span",null,C(t(n).m),1),o[5]||(o[5]=e("span",{op50:""},":",-1)),e("span",null,C(t(n).s),1),e("span",Re,"."+C(t(n).ms),1)])],2))}}),Ee={class:"bg-main h-full slidev-presenter grid grid-rows-[max-content_1fr] of-hidden"},Ie={flex:"~ gap-4 items-center",border:"b main",p1:""},Oe={class:"relative grid-section next flex flex-col p-2 lg:p-4"},We={key:1,class:"h-full flex justify-center items-center"},Ge={key:0,class:"grid-section note of-auto"},He={key:1,class:"grid-section note grid grid-rows-[1fr_min-content] overflow-hidden"},Ue={class:"grid-section bottom flex"},qe=z({__name:"presenter",setup(p){const l=V(),n=B();pe(),fe(n),ve();const{clicksContext:a,currentSlideNo:c,currentSlideRoute:f,hasNext:o,nextRoute:d,slides:_,getPrimaryClicks:S}=ee(),{isDrawing:D}=de();te({title:`Presenter - ${le}`}),B(!1);const N=$(()=>_.value.map(g=>{const s=B(0);return{context:se(s,g?.meta.slide?.frontmatter.clicksStart??0,g?.meta.clicks),clicks:s}})),v=$(()=>a.value.current<a.value.total?[f.value,a.value.current+1]:o.value?[d.value,0]:null),w=$(()=>v.value&&N.value[v.value[0].no-1]);R(v,()=>{w.value&&v.value&&(w.value.clicks.value=v.value[1])},{immediate:!0});const y=K("slidev-presenter-main-slide-mode","slides"),L=T();return Q(()=>{const g=n.value.querySelector("#slide-content"),s=Y(J()),A=V();R(()=>{if(!A.value||D.value||!ue.value||!g)return;const k=g.getBoundingClientRect(),F=(s.x-k.left)/k.width*100,P=(s.y-k.top)/k.height*100;if(!(F<0||F>100||P<0||P>100))return{x:F,y:P}},k=>{r.cursor=k})}),(g,s)=>(i(),m(G,null,[e("div",Ee,[e("div",null,[u(he)]),e("div",{class:b(["grid-container",`layout${t(ne)}`])},[e("div",{ref_key:"main",ref:n,class:"relative grid-section main flex flex-col"},[e("div",Ie,[s[3]||(s[3]=e("span",{op50:"",px2:""},"Current",-1)),s[4]||(s[4]=e("div",{"flex-auto":""},null,-1)),u(xe,{modelValue:t(y),"onUpdate:modelValue":s[0]||(s[0]=A=>X(y)?y.value=A:null),options:[{label:"Slides",value:"slides"},{label:"Screen Mirror",value:"mirror"}]},null,8,["modelValue"])]),t(y)==="mirror"?(i(),x(Ae,{key:0})):M("",!0),O(u(E,{key:"main",class:"p-2 lg:p-4 flex-auto","is-main":"",onContextmenu:t(_e)},{default:h(()=>[u(ke,{"render-context":"presenter"})]),_:1},8,["onContextmenu"]),[[W,t(y)==="slides"]]),(i(),x(Ce,{key:t(f)?.no,"clicks-context":t(S)(t(f)),class:"w-full pb2 px4 flex-none"},null,8,["clicks-context"]))],512),e("div",Oe,[v.value&&w.value?(i(),x(E,{key:"next"},{default:h(()=>[(i(),x(me,{key:v.value[0].no,"clicks-context":w.value.context,route:v.value[0],"render-context":"previewNext"},null,8,["clicks-context","route"]))]),_:1})):(i(),m("div",We,s[5]||(s[5]=[e("div",{class:"text-gray-500"}," End of the presentation ",-1)]))),s[6]||(s[6]=e("div",{class:"absolute left-0 top-0 bg-main border-b border-r border-main px2 py1 op50 text-sm"}," Next ",-1))]),L.value&&t(oe)?(i(),m("div",Ge,[u(t(L))])):(i(),m("div",He,[(i(),x(ze,{key:`static-${t(c)}`,no:t(c),class:"w-full max-w-full h-full overflow-auto p-2 lg:p-4",style:Z({fontSize:`${t(re)}em`}),"clicks-context":t(a)},null,8,["no","style","clicks-context"])),s[10]||(s[10]=e("div",{"border-t":"","border-main":""},null,-1)),e("div",{class:b(["py-1 px-2 text-sm transition",t(l)?"":"op25"])},[u(I,{title:"Increase font size",onClick:t(ae)},{default:h(()=>s[7]||(s[7]=[e("div",{class:"i-carbon:zoom-in"},null,-1)])),_:1,__:[7]},8,["onClick"]),u(I,{title:"Decrease font size",onClick:t(ie)},{default:h(()=>s[8]||(s[8]=[e("div",{class:"i-carbon:zoom-out"},null,-1)])),_:1,__:[8]},8,["onClick"]),M("",!0)],2)])),e("div",Ue,[u(ge,{persist:!0,class:b(["transition",t(l)?"":"op25"])},null,8,["class"]),s[11]||(s[11]=e("div",{"flex-auto":""},null,-1)),u(Ve)]),(i(),x($e,{key:2}))],2)]),u(Se),u(ye),u(be)],64))}}),at=ce(qe,[["__scopeId","data-v-1b960237"]]);export{at as default};
